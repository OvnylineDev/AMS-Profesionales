<!doctype html>
<html lang="es-ES">

<head>
	<meta charset="utf-8" />
	<meta http-equiv="x-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" /><meta http-equiv="Last-Modified" content="0">
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<title>Gesti√≥n de Intervenciones 1.0</title>
	<script src="./resources/js/jq.js"></script>

	<script src="./resources/js/gv.js"></script>
	<script src="./resources/js/sp.js"></script>
	<link href="./resources/css/w3.css" rel="stylesheet">
	<link href="./resources/css/style.css" rel="stylesheet">
	<link href="./resources/fa/css/font-awesome.css" rel="stylesheet">
	<style>
		.element {
			display: inline-flex;
			align-items: center;
		}

		i.fa-camera,
		i.fa-image {
			margin: 10px;
			cursor: pointer;
			font-size: 30px;
		}

		i:hover {
			opacity: 0.6;
		}

		#fileupload {
			display: none;
		}

		.modal .campo .cross{
			position: absolute;
			right:0;
		}

		#modalfield input {
			width: 100%;
			height: 50px;
			margin-bottom: 10px;
		}
	</style>
</head>

<body class="w3-large">
	<video id="video"></video>
	<button id="startbutton">Take photo</button>
	<canvas id="canvas"></canvas>
	<img src="http://placekitten.com/g/320/261" id="photo" alt="photo">

	<script>
	(function() {

		var streaming = false,
		 video        = document.querySelector('#video'),
		 canvas       = document.querySelector('#canvas'),
		 photo        = document.querySelector('#photo'),
		 startbutton  = document.querySelector('#startbutton'),
		 width = 320,
		 height = 0;

		navigator.getMedia = ( navigator.getUserMedia ||
						navigator.webkitGetUserMedia ||
						navigator.mozGetUserMedia ||
						navigator.msGetUserMedia);

		navigator.getMedia(
		{
		 video: true,
		 audio: false
		},
		function(stream) {
		 if (navigator.mozGetUserMedia) {
		   video.mozSrcObject = stream;
		 } else {
		   var vendorURL = window.URL || window.webkitURL;
		   video.src = vendorURL.createObjectURL(stream);
		 }
		 video.play();
		},
		function(err) {
		 console.log("An error occured! " + err);
		}
		);

		video.addEventListener('canplay', function(ev){
		if (!streaming) {
		 height = video.videoHeight / (video.videoWidth/width);
		 video.setAttribute('width', width);
		 video.setAttribute('height', height);
		 canvas.setAttribute('width', width);
		 canvas.setAttribute('height', height);
		 streaming = true;
		}
		}, false);

		function takepicture() {
		canvas.width = width;
		canvas.height = height;
		canvas.getContext('2d').drawImage(video, 0, 0, width, height);
		var data = canvas.toDataURL('image/png');
		photo.setAttribute('src', data);
		}

		startbutton.addEventListener('click', function(ev){
		 takepicture();
		ev.preventDefault();
		}, false);

	})();
	</script>
</body>

</html>
